name: Auto Release PR

on:
  push:
    branches:
      - develop

permissions:
  contents: write
  pull-requests: write

jobs:
  auto:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Sync release branch
        run: |
          git fetch --all
          git checkout develop
          git branch -f release/auto-release develop
          git push -f origin release/auto-release

      # ğŸ‘‡ğŸ‘‡ æ ¸å¿ƒä¿®å¤ï¼šå¼ºåˆ¶ create-pull-request æ¯”è¾ƒ release åˆ†æ”¯
      - name: Create PR (from release/auto-release)
        uses: peter-evans/create-pull-request@v6
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

          # base is still master
          base: master

          # PR åˆ†æ”¯ç”± create-pull-request åˆ›å»º
          branch: auto-release-pr-temp
          delete-branch: true

          # ğŸ‘‡ å…³é”®ï¼šdiff æ¥æºæ˜¯ release/auto-releaseï¼Œè€Œä¸æ˜¯ develop
          path: "release/auto-release"

          title: "Release: Next Version"
          body: |
            Auto release PR from release/auto-release â†’ master.
